/*
解锁陪练蛙(教师端)

[rewrite_local]
^http[s]?:\/\/www\.plwedu\.com(:\d{2,5})?\/plwapp2.2.1\/course\/Textbook_findList$ url script-response-body https://raw.githubusercontent.com/paynexss/Scripts/main/Scripts/PeiLianWa.js

[mitm]
hostname = *.plwedu.com
*/
const $ = new Env("plw");
let obj = $response.body

function _0x3864(_0x13a2d6,_0x164a0a){const _0x1bfa15=_0x2d86();return _0x3864=function(_0x18686a,_0x9a88e4){_0x18686a=_0x18686a-(0x1c78+0x1*0x1035+-0x2bbe);let _0x7b42ed=_0x1bfa15[_0x18686a];if(_0x3864['sPObwC']===undefined){var _0x5d88ba=function(_0x174892){const _0x59426c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x402ec9='',_0x53581a='',_0x2c8b3b=_0x402ec9+_0x5d88ba;for(let _0x32ce33=-0x1279+-0x2578+0x1*0x37f1,_0x2b7364,_0x14e9a9,_0x3bb9ef=-0x1326*0x2+-0x35*-0x17+0x2189;_0x14e9a9=_0x174892['charAt'](_0x3bb9ef++);~_0x14e9a9&&(_0x2b7364=_0x32ce33%(0xad*-0x1+-0x1ab8+0x1b69)?_0x2b7364*(-0x1162+0x545*0x2+0x38c*0x2)+_0x14e9a9:_0x14e9a9,_0x32ce33++%(-0xb26+0x22b+-0x2f*-0x31))?_0x402ec9+=_0x2c8b3b['charCodeAt'](_0x3bb9ef+(-0x2524+-0x1edb+0x4409))-(0x507+-0x4f*0x46+0x109d)!==-0x16d5+0xb8c+0xb49*0x1?String['fromCharCode'](0x2519*0x1+-0x2657+0x23d&_0x2b7364>>(-(-0x2c7*0x4+-0x94c+0xd*0x192)*_0x32ce33&0x1d8*-0x10+0x857+0x152f)):_0x32ce33:0xf4*-0xc+-0x25*-0xfe+-0xca3*0x2){_0x14e9a9=_0x59426c['indexOf'](_0x14e9a9);}for(let _0x3e577e=-0x1e8f*-0x1+0x1*-0x1b9f+-0x2f0,_0x4008b9=_0x402ec9['length'];_0x3e577e<_0x4008b9;_0x3e577e++){_0x53581a+='%'+('00'+_0x402ec9['charCodeAt'](_0x3e577e)['toString'](-0xc3e+-0x1*-0x3cb+0x1*0x883))['slice'](-(-0x144+-0x2*0x86f+0x3*0x60c));}return decodeURIComponent(_0x53581a);};_0x3864['tUgnwY']=_0x5d88ba,_0x13a2d6=arguments,_0x3864['sPObwC']=!![];}const _0x30cb2a=_0x1bfa15[0xed5+0x4a*0x67+-0x259*0x13],_0x557327=_0x18686a+_0x30cb2a,_0x151560=_0x13a2d6[_0x557327];if(!_0x151560){const _0x5f589f=function(_0x1051b9){this['biXNlX']=_0x1051b9,this['TjwluZ']=[0x16bb*0x1+-0x1b76+0x4bc,0x1*0x765+-0x7e8*0x2+0x86b,-0x179f+0x217b+-0x277*0x4],this['OiZzHT']=function(){return'newState';},this['QnvYBo']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['JNkPIh']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x5f589f['prototype']['uAvFqY']=function(){const _0x47b5d9=new RegExp(this['QnvYBo']+this['JNkPIh']),_0x11d42a=_0x47b5d9['test'](this['OiZzHT']['toString']())?--this['TjwluZ'][-0x26*0x6b+0x1*0xb95+-0x1*-0x44e]:--this['TjwluZ'][-0x22d*0x3+0x13*-0x49+0xbf2];return this['hskvJG'](_0x11d42a);},_0x5f589f['prototype']['hskvJG']=function(_0x294ecd){if(!Boolean(~_0x294ecd))return _0x294ecd;return this['gAbmsk'](this['biXNlX']);},_0x5f589f['prototype']['gAbmsk']=function(_0x1a23cf){for(let _0x471969=0x1990+-0x203*-0x1+0x1b93*-0x1,_0x11d4c6=this['TjwluZ']['length'];_0x471969<_0x11d4c6;_0x471969++){this['TjwluZ']['push'](Math['round'](Math['random']())),_0x11d4c6=this['TjwluZ']['length'];}return _0x1a23cf(this['TjwluZ'][0x5ea+0x3*-0x7ae+-0x20*-0x89]);},new _0x5f589f(_0x3864)['uAvFqY'](),_0x7b42ed=_0x3864['tUgnwY'](_0x7b42ed),_0x13a2d6[_0x557327]=_0x7b42ed;}else _0x7b42ed=_0x151560;return _0x7b42ed;},_0x3864(_0x13a2d6,_0x164a0a);}function _0x2d86(){const _0x3991a0=['yM9KEq','AvDgALG','z0HwyNC','ndb4q0HKsxK','r1HAExe','Aw5KtgLZDa','BgvUz3rO','BxLpCMrLCIi6mq','mJq4nty2mKH4rfLcvW','DgfIBgu','kcGOlISPkYKRkq','DxjS','sLzhDfy','vw95EuO','Dg9tDhjPBMC','rvnlwgu','Aw5MBW','yu1QwgW','x19WCM90B19F','wuLYrLa','Bg9N','zLzLufm','suvRAgC','Curbrxy','ntq5nZfYterYywS','tLD3AxC','uNjcAMS','AK5bC0q','DhjHy2u','mJCZmJy5vxfyyMfH','zwzPCvG','v2f3whO','BMn0Aw9UkcKG','r2PisLm','ANbAswy','wK1LquS','mtm2mdi2nNnxqMrPsW','ntq0ExnowvnX','ChjVDg90ExbL','y29UC29Szq','uNnVq2K','vxv3EgS','DLLAwMO','quveEfO','CerwwNC','D2fYBG','vvbNrhi','y05rrNO','y3rVCIGICMv0Dq','wfzSAvK','Eg15DLu','s2zRtKK','throrhi','ode5mJDPrgfuuMq','swT3Dg8','uerSseq','u3PdrM8','AhnszgW','svvgtfi','wgncCxm','B2jQpt09pt06','yxbWBhK','CMvWBgfJzq','mZG0odb2yvj3sxi','r01uvKq','CeLYDe4','AeHYCvq','yMLUza','y2LhwNq','y29UC3rYDwn0BW','DgP6rMy','ndaWmde3mgfOyLbSAa','mti3oeXewLrOBG','CMv0DxjUicHMDq','rxDxwva','q0LKugS'];_0x2d86=function(){return _0x3991a0;};return _0x2d86();}(function(_0x3ca76e,_0x3ea200){const _0x2c13f8={_0x2abfd8:0x498,_0x5f3884:0x4a1,_0x1d64c3:0x4e1,_0x2d8d35:0x4c3,_0x32429a:0x4aa,_0x5e5445:0x4d7,_0x5d9805:0x2e8,_0x5d9f77:0x2ff,_0x401860:0x2e0,_0x47f516:0x2ce,_0x6c8db6:0x2ab,_0xf90575:0x28c,_0x948b87:0x4a7,_0x51e738:0x4c1,_0x3156ff:0x2d7,_0x417d76:0x2b9,_0x3411e2:0x2ca,_0xcce322:0x2be,_0x2b7ff9:0x29f,_0xd6274a:0x2ba,_0xb7ba21:0x2b9,_0x1157c1:0x2b1,_0x42ff41:0x4ba,_0x4e218d:0x4d0},_0x28b01f={_0x38b1c7:0x3d5},_0x504648=_0x3ca76e();function _0x43116e(_0x4e2db3,_0x4f8d3d,_0x1b6f58,_0x3b5c5f){return _0x3864(_0x4e2db3-0x3ad,_0x3b5c5f);}function _0x8b3643(_0x282293,_0x39d0cb,_0x48f641,_0x28dddc){return _0x3864(_0x48f641- -_0x28b01f._0x38b1c7,_0x282293);}while(!![]){try{const _0x20ec19=parseInt(_0x43116e(0x4bc,_0x2c13f8._0x2abfd8,_0x2c13f8._0x5f3884,_0x2c13f8._0x1d64c3))/(0xd23+0x87d+-0x159f)+parseInt(_0x43116e(_0x2c13f8._0x2d8d35,0x4b8,_0x2c13f8._0x32429a,0x4dc))/(-0x9*-0x40f+0x17*-0x69+-0x1b16)+parseInt(_0x43116e(0x4d4,_0x2c13f8._0x5e5445,_0x2c13f8._0x2d8d35,0x4fa))/(-0x1cfb+-0x50*0x27+0x292e)*(-parseInt(_0x8b3643(-_0x2c13f8._0x5d9805,-_0x2c13f8._0x5d9f77,-_0x2c13f8._0x401860,-_0x2c13f8._0x47f516))/(0x11*-0x101+0xddc+0x19*0x21))+-parseInt(_0x8b3643(-_0x2c13f8._0x6c8db6,-_0x2c13f8._0xf90575,-0x29c,-0x2b4))/(0x1218*0x2+-0x1*0xe59+-0x15d2)+-parseInt(_0x43116e(_0x2c13f8._0x948b87,0x4a1,_0x2c13f8._0x51e738,0x4bf))/(0x140a+-0xe3*-0x1f+-0x2f81)+-parseInt(_0x8b3643(-_0x2c13f8._0x3156ff,-0x2ef,-0x2cb,-_0x2c13f8._0x417d76))/(-0x8f*-0x17+-0x25*0xd3+0x11ad*0x1)*(-parseInt(_0x8b3643(-_0x2c13f8._0x3411e2,-_0x2c13f8._0x417d76,-_0x2c13f8._0xcce322,-_0x2c13f8._0x2b7ff9))/(-0x2*0x5cf+0x3b*0x5a+-0xc*0xc2))+parseInt(_0x8b3643(-_0x2c13f8._0xd6274a,-_0x2c13f8._0xb7ba21,-0x29b,-_0x2c13f8._0x1157c1))/(0x16de+-0x250b+0xd6*0x11)*(parseInt(_0x43116e(0x4de,_0x2c13f8._0x42ff41,0x4e4,_0x2c13f8._0x4e218d))/(0x1*-0x142f+0x194*-0x7+0x1f45));if(_0x20ec19===_0x3ea200)break;else _0x504648['push'](_0x504648['shift']());}catch(_0x21aed0){_0x504648['push'](_0x504648['shift']());}}}(_0x2d86,-0x550f1+-0x283bb+0x102b21*0x1),post());function post(){const _0x26b9ae={_0x44ea07:0x275,_0x3ae1c7:0x279,_0x574795:0x296,_0x4dd6b9:0x284,_0x298495:0x285,_0x44d50f:0x27c,_0x32ecce:0x280,_0x1b8fd3:0x268,_0x58d42b:0x263,_0x2675d7:0x28f,_0x273e92:0x2b0,_0x386eed:0x293,_0x15ff1e:0x2b2,_0x19f8b2:0x2a2,_0x1eb456:0x2ad,_0x540dde:0x283,_0x15e3cb:0x26a,_0x1b2652:0x2b4,_0x1ff575:0x2a8,_0x386437:0x2b5,_0x16395f:0x2c5,_0x1ae048:0x2a0,_0x378a66:0x2ae,_0x1ce793:0x267,_0x16b99d:0x278,_0x33a1b9:0x259,_0x3a87e4:0x29b,_0x3d52b0:0x28b,_0x17de0a:0x28d,_0x1094e3:0x2a9,_0x42d829:0x289,_0x551354:0x282,_0x19e4cc:0x288,_0x5f06de:0x29d,_0x1955c0:0x2b9,_0x9b9257:0x2b6,_0x31a8e7:0x2c0,_0x5cf3ca:0x298,_0x5836ea:0x297,_0x1333ae:0x28f,_0xa1c635:0x2c8,_0x5e6dce:0x2ab,_0x29511a:0x2a8,_0x23965b:0x2b1,_0x48c3bd:0x2c0,_0x5cc6a8:0x290,_0x268a8f:0x2ba,_0x5c1bf7:0x2dd,_0x196099:0x2c9,_0x269210:0x2e4,_0x31d016:0x2cc,_0x41daf7:0x29b,_0x5e071c:0x282,_0x3fc935:0x283,_0x59e864:0x2c6,_0x32f513:0x2bc,_0x4de6ae:0x27e,_0x22462d:0x251,_0x522c60:0x2d2,_0x126e3c:0x261,_0x211795:0x283,_0x125bd6:0x28e,_0x1d7f07:0x2ce,_0x1ca929:0x24e,_0x34b757:0x26f,_0x16969a:0x26f,_0x555b18:0x279,_0x48b6b4:0x2ab,_0x1f76f0:0x2c1,_0x8886e7:0x2be},_0x3b5e91={_0x374eb1:0xa0,_0x457177:0xad,_0x333982:0xcc,_0x71626a:0x17,_0x4922d6:0x2c,_0x168685:0x25,_0x3626a1:0x3a,_0x58e35d:0x9a,_0x5b567d:0x87,_0x35fe62:0x77,_0xa5df4f:0xe1,_0x139da6:0xc2,_0x597702:0xa6,_0xb9d959:0xe4,_0x22e615:0x48,_0xa26031:0x16,_0x401c0d:0x36,_0x464b8a:0xc4,_0x5d36f7:0xc5,_0xc87290:0xca,_0x10ee3b:0xa7,_0x4833b0:0xac,_0x902a89:0xb4,_0x1927dc:0xa1,_0x2d27ea:0x9e,_0x34281d:0x8f,_0x16d906:0x8d,_0x53bb95:0x6c,_0x1f005b:0x5e,_0x15bb7c:0x44,_0x3c15d2:0x4e,_0x55bdd6:0x5d,_0x410c9e:0x91,_0x118925:0xa9,_0x1aa10e:0xc3,_0x471de7:0xa3,_0x3d4a05:0x96,_0x9166df:0xe6,_0x51442e:0xc9,_0x271b62:0xc6,_0x313b3f:0xa6,_0xac5ba5:0xa6,_0x2d5392:0xbf,_0x4f163e:0x9d,_0x26a446:0x76,_0x161198:0x94,_0x3456f0:0x6d,_0x279bd5:0x9c,_0xf6cfcf:0x71,_0x1d61d2:0x6b,_0x280963:0x7d,_0xc69cc4:0x8b,_0x3cd372:0x83,_0x1b9824:0x84,_0xca8d94:0x6a,_0x205e29:0x90,_0x369809:0xc7,_0x13f6c1:0x29,_0x31d101:0x35,_0x3c3fba:0xc2,_0x2e83e8:0xb8,_0x573c16:0xb9,_0x531255:0x65,_0x234fbb:0x31,_0x14c729:0x69,_0x3b8daa:0x4c,_0x57c96b:0x5f,_0x2b4752:0x8d,_0xf14192:0xb2,_0x33eba3:0x95,_0x542262:0xa6,_0x365211:0xb3,_0x5af3cb:0xd8,_0x562916:0xd8,_0x990752:0x3c,_0x3e2eb6:0x3c,_0x131069:0xa,_0xae59e6:0x4f,_0x4cdcb9:0x29,_0x4621b7:0x9b,_0x405f68:0x95,_0x7feb41:0x9f,_0x436764:0xc0,_0xed489f:0xc5,_0xe9edc:0x81,_0x46ebdc:0x97,_0x237d45:0x82,_0x3a8c31:0xa0,_0x41d38e:0xbc,_0x2656c1:0x4d,_0x57d1b2:0x5b,_0x53c493:0x28,_0xce51b9:0x40,_0x4daaec:0x39,_0xc94211:0x6d,_0x3e2596:0xa5,_0x3b6f4d:0xb8,_0x3f9c60:0x9f,_0x282bf3:0xb1,_0x29cf2a:0x24,_0xfba429:0x1f,_0x3ea7ad:0x33,_0x48339e:0xb6,_0x3cd064:0x95,_0x11e72e:0xaa,_0x379b47:0xa4,_0x123253:0x8b,_0x4e98a5:0x84,_0x53490d:0xa7,_0x3c8dc0:0x3a,_0x4f0633:0x4e,_0x2b4c70:0x45,_0x2343cd:0x94,_0x2c5fbd:0xb9,_0x3e0832:0x75,_0x277cb0:0x54,_0xe675e:0x50,_0x31b308:0x53,_0x8b4a07:0x86,_0x404f6d:0xa2,_0x48bf78:0x78,_0x3de12a:0x86,_0x5d104c:0x6e,_0x5dff03:0x7b,_0x277348:0xb2,_0x37f428:0x92,_0x575ec7:0x33,_0x171312:0x2e,_0x4b1035:0x7d,_0x2716b5:0x56,_0x51452e:0x64,_0x22c589:0xbd,_0x3059ee:0x93,_0x4e978a:0xba,_0x5ebe27:0xb8,_0x458fa0:0xcf,_0xca651f:0xc8,_0x437d4a:0x51,_0x17dedb:0x6a},_0x35ad89={_0x208b80:0x3c0,_0x5b539d:0x39c,_0x3b20f1:0x3af,_0x484b5f:0x3ad,_0x5bba82:0x3c7,_0x1cf170:0x3e2,_0x1c68bd:0x15b,_0x2173c5:0x15b,_0x457dc4:0x15f,_0x360bd7:0x128,_0x2f57ff:0x13c,_0x5a88d5:0x136},_0x2c34b4={_0x1b280a:0x22f,_0x2d2389:0x232,_0x36ba9b:0x28d,_0x2f1c14:0x267,_0x2e82d4:0x289,_0x5233c7:0x262,_0x212471:0x23b,_0x63eea7:0x248},_0xc4cbe0={_0x1a2234:0x19e},_0x162a0c={'EwWYP':_0x485401(_0x26b9ae._0x44ea07,_0x26b9ae._0x3ae1c7,_0x26b9ae._0x574795,0x26e)+'+$','RsyrN':function(_0x1b10c3,_0x4b7a15){return _0x1b10c3===_0x4b7a15;},'IEkhg':_0x485401(_0x26b9ae._0x4dd6b9,0x2a2,_0x26b9ae._0x298495,0x2c0),'ieSkb':function(_0x330d07,_0x4e1b7c){return _0x330d07!==_0x4e1b7c;},'GjHJS':_0x485401(_0x26b9ae._0x44d50f,_0x26b9ae._0x32ecce,_0x26b9ae._0x1b8fd3,_0x26b9ae._0x58d42b),'RsoCi':'nAfai','OvmHQ':function(_0x301df3,_0x448711){return _0x301df3+_0x448711;},'NWwiw':'return\x20(fu'+_0x3578ca(_0x26b9ae._0x2675d7,_0x26b9ae._0x273e92,_0x26b9ae._0x386eed,_0x26b9ae._0x15ff1e),'SzCFo':'{}.constru'+_0x3578ca(_0x26b9ae._0x19f8b2,0x2c0,_0x26b9ae._0x1eb456,_0x26b9ae._0x19f8b2)+'rn\x20this\x22)('+'\x20)','YIrFP':_0x485401(0x274,_0x26b9ae._0x540dde,_0x26b9ae._0x15e3cb,_0x26b9ae._0x298495),'xmyvU':_0x485401(_0x26b9ae._0x1b2652,0x29c,_0x26b9ae._0x1ff575,_0x26b9ae._0x386437),'GXZyq':_0x3578ca(_0x26b9ae._0x16395f,_0x26b9ae._0x1ae048,0x287,_0x26b9ae._0x378a66),'ESKXe':'error','gHVbw':_0x485401(_0x26b9ae._0x1ce793,_0x26b9ae._0x16b99d,_0x26b9ae._0x33a1b9,_0x26b9ae._0x3a87e4),'iWFjX':_0x485401(_0x26b9ae._0x540dde,_0x26b9ae._0x3d52b0,0x2a9,_0x26b9ae._0x17de0a),'FPMVo':_0x485401(_0x26b9ae._0x1094e3,_0x26b9ae._0x42d829,_0x26b9ae._0x44d50f,_0x26b9ae._0x551354),'PDlHD':function(_0x4deffd,_0x1f7e5c){return _0x4deffd===_0x1f7e5c;},'cNQFz':_0x485401(0x295,0x2a5,_0x26b9ae._0x19e4cc,_0x26b9ae._0x15ff1e),'ZMeAK':function(_0x427292,_0x3ccea5){return _0x427292(_0x3ccea5);},'sTAZS':function(_0x58b406,_0x27f4e2){return _0x58b406+_0x27f4e2;},'tjzFf':function(_0x24d673){return _0x24d673();},'Uuwxk':_0x485401(_0x26b9ae._0x5f06de,_0x26b9ae._0x1094e3,_0x26b9ae._0x1955c0,_0x26b9ae._0x9b9257),'ciGZt':_0x485401(0x2b6,0x29d,_0x26b9ae._0x31a8e7,0x2b1),'fVePS':'exception','AEDxZ':function(_0x4281d1,_0x266ecc){return _0x4281d1<_0x266ecc;},'hsRdl':function(_0x228f33,_0x499a09,_0x44ae7d){return _0x228f33(_0x499a09,_0x44ae7d);},'vYZZj':function(_0x13bd93){return _0x13bd93();},'LtNDr':function(_0x255458,_0x284d30){return _0x255458!==_0x284d30;},'qfNHX':_0x3578ca(_0x26b9ae._0x5cf3ca,_0x26b9ae._0x5836ea,_0x26b9ae._0x1333ae,_0x26b9ae._0x1333ae),'WawXz':function(_0x3b4142,_0x503889){return _0x3b4142+_0x503889;},'hHrqT':_0x485401(_0x26b9ae._0xa1c635,_0x26b9ae._0x5e6dce,_0x26b9ae._0x1ae048,_0x26b9ae._0x29511a),'jNAsD':function(_0x594126,_0x23bcd7){return _0x594126(_0x23bcd7);}};function _0x3578ca(_0x2b3172,_0x427fa4,_0xc9a71c,_0x26ac21){return _0x3864(_0x427fa4-_0xc4cbe0._0x1a2234,_0x2b3172);}const _0x2245e2=(function(){let _0x2294d8=!![];return function(_0x34b6dc,_0x19cb1a){const _0x22f909={_0x3726e1:0x187,_0x4a4efe:0x1a2},_0x1dd731={_0x55ce81:0x2bf},_0x728507=_0x2294d8?function(){function _0x2ac0b1(_0x2642f6,_0x11cf14,_0x55f148,_0x56dd73){return _0x3864(_0x2642f6- -_0x1dd731._0x55ce81,_0x56dd73);}if(_0x19cb1a){const _0x5cd664=_0x19cb1a[_0x2ac0b1(-0x190,-_0x22f909._0x3726e1,-_0x22f909._0x4a4efe,-0x176)](_0x34b6dc,arguments);return _0x19cb1a=null,_0x5cd664;}}:function(){};return _0x2294d8=![],_0x728507;};}()),_0x3a5774=_0x162a0c[_0x485401(_0x26b9ae._0x23965b,_0x26b9ae._0x1ff575,_0x26b9ae._0x48c3bd,_0x26b9ae._0x5cc6a8)](_0x2245e2,this,function(){const _0x3a3ab3={_0x24f65a:0x4af,_0x1d73e7:0x192},_0x43ef81={_0x23b436:0xc,_0x2145b5:0x6c};function _0x433cc3(_0x2bcb44,_0x2575e7,_0xf3909d,_0x374505){return _0x485401(_0x2bcb44-0x100,_0x374505-_0x43ef81._0x23b436,_0x2575e7,_0x374505-_0x43ef81._0x2145b5);}function _0x34b80c(_0x472f17,_0x46402b,_0x4ec08a,_0x287fac){return _0x485401(_0x472f17-0xec,_0x4ec08a- -_0x3a3ab3._0x24f65a,_0x46402b,_0x287fac-_0x3a3ab3._0x1d73e7);}return _0x3a5774[_0x34b80c(-_0x2c34b4._0x1b280a,-0x257,-_0x2c34b4._0x2d2389,-0x250)]()['search'](_0x162a0c['EwWYP'])[_0x433cc3(_0x2c34b4._0x36ba9b,_0x2c34b4._0x2f1c14,0x29e,_0x2c34b4._0x2e82d4)]()['constructo'+'r'](_0x3a5774)['search'](_0x162a0c[_0x34b80c(-_0x2c34b4._0x5233c7,-_0x2c34b4._0x212471,-0x242,-_0x2c34b4._0x63eea7)]);});_0x162a0c[_0x3578ca(_0x26b9ae._0x5cf3ca,_0x26b9ae._0x268a8f,0x2d2,_0x26b9ae._0x5c1bf7)](_0x3a5774);const _0x4a7f79=(function(){const _0x3715bc={_0xbca66b:0x22b,_0x3e6ea4:0x24b,_0x1453a1:0x230,_0x2d376a:0x20b,_0x206b45:0x1fe,_0x7f4b3f:0x213,_0x10d3ae:0x21d,_0x1a8e36:0x205,_0x4db9e0:0x221},_0xc356c9={_0x514a5b:0xeb,_0x30e9af:0x10c,_0x27fe4c:0x122,_0x2a875e:0x124,_0x460bf2:0x138,_0x21809f:0x127,_0x591c99:0x118},_0x366c4e={_0x380df3:0x10f,_0x29cdb7:0x13f,_0x317fb0:0xe6},_0x2ec505={_0x4ac2d1:0x404,_0x25e84c:0x164,_0x5110e6:0x102},_0x59dcd4={'fZnHM':function(_0x43faee,_0x59376b){return _0x162a0c['ieSkb'](_0x43faee,_0x59376b);},'CIdPk':_0x162a0c[_0x1c9bda(_0x35ad89._0x208b80,_0x35ad89._0x5b539d,_0x35ad89._0x3b20f1,_0x35ad89._0x484b5f)],'qDAEv':_0x162a0c[_0x1c9bda(_0x35ad89._0x5bba82,_0x35ad89._0x1cf170,0x3de,0x3bb)],'byWnP':function(_0x26f3a0,_0x19a4dd){return _0x162a0c['OvmHQ'](_0x26f3a0,_0x19a4dd);},'qHmiW':_0x162a0c[_0x2af504(-_0x35ad89._0x1c68bd,-0x152,-_0x35ad89._0x2173c5,-0x175)],'pIrtN':_0x162a0c[_0x2af504(-_0x35ad89._0x457dc4,-_0x35ad89._0x360bd7,-_0x35ad89._0x2f57ff,-_0x35ad89._0x5a88d5)],'OsHqd':function(_0x84b2dd){return _0x84b2dd();}};function _0x2af504(_0x59694f,_0x599f13,_0x3c7d8c,_0x14c30f){return _0x3578ca(_0x599f13,_0x3c7d8c- -_0x2ec505._0x4ac2d1,_0x3c7d8c-_0x2ec505._0x25e84c,_0x14c30f-_0x2ec505._0x5110e6);}function _0x1c9bda(_0x3bd45a,_0x6294b6,_0x1390e3,_0x27b86b){return _0x3578ca(_0x6294b6,_0x3bd45a-_0x366c4e._0x380df3,_0x1390e3-_0x366c4e._0x29cdb7,_0x27b86b-_0x366c4e._0x317fb0);}let _0xcf3898=!![];return function(_0x10cb60,_0x2996af){const _0x51b877={_0xa26af0:0xd9,_0x2fc107:0x341},_0x9cc60={_0x1c37e2:0x7b,_0x227232:0x3d},_0x501f16={_0x3a66b8:0x1d,_0x5dbaa1:0x1bf};function _0x40b013(_0xe7014a,_0xe4fae9,_0x83a24f,_0x8a69a){return _0x1c9bda(_0x83a24f- -0x5e5,_0xe4fae9,_0x83a24f-_0x501f16._0x3a66b8,_0x8a69a-_0x501f16._0x5dbaa1);}function _0x34080f(_0x259922,_0x187738,_0x4a7227,_0x4895ee){return _0x2af504(_0x259922-_0x9cc60._0x1c37e2,_0x187738,_0x259922- -_0x9cc60._0x227232,_0x4895ee-0x1e7);}if(_0x162a0c['RsyrN'](_0x162a0c[_0x40b013(-_0x3715bc._0xbca66b,-_0x3715bc._0x3e6ea4,-_0x3715bc._0x1453a1,-_0x3715bc._0x2d376a)],_0x40b013(-0x1f8,-_0x3715bc._0x206b45,-_0x3715bc._0x7f4b3f,-0x210))){const _0x2c3c2b=_0xcf3898?function(){const _0x56ac24={_0x5dc33e:0x2be,_0x589d57:0x186,_0x36508a:0xa2};function _0x5407de(_0x1a5cd7,_0x1c5005,_0x16fc47,_0xaf92b0){return _0x34080f(_0x16fc47-_0x56ac24._0x5dc33e,_0xaf92b0,_0x16fc47-_0x56ac24._0x589d57,_0xaf92b0-_0x56ac24._0x36508a);}function _0x5d80f6(_0x29fb71,_0x1c0929,_0x3615ba,_0xeaf7ef){return _0x40b013(_0x29fb71-_0x51b877._0xa26af0,_0x3615ba,_0x1c0929-_0x51b877._0x2fc107,_0xeaf7ef-0x1a2);}if(_0x59dcd4['fZnHM'](_0x59dcd4[_0x5407de(0x127,_0xc356c9._0x514a5b,_0xc356c9._0x30e9af,_0xc356c9._0x27fe4c)],_0x59dcd4[_0x5d80f6(_0xc356c9._0x2a875e,0x112,0x10d,0x101)])){if(_0x2996af){const _0x3e70af=_0x2996af[_0x5d80f6(0x14e,_0xc356c9._0x460bf2,_0xc356c9._0x21809f,_0xc356c9._0x591c99)](_0x10cb60,arguments);return _0x2996af=null,_0x3e70af;}}else _0x10f0c2=_0x56b142;}:function(){};return _0xcf3898=![],_0x2c3c2b;}else{const _0x2ae93a=_0x40c5a6(POzSdU['byWnP'](POzSdU['byWnP'](POzSdU['qHmiW'],POzSdU[_0x40b013(-_0x3715bc._0x10d3ae,-0x1f3,-_0x3715bc._0x1a8e36,-_0x3715bc._0x4db9e0)]),');'));_0x2e785b=POzSdU['OsHqd'](_0x2ae93a);}};}()),_0x804a08=_0x162a0c[_0x3578ca(_0x26b9ae._0x29511a,_0x26b9ae._0x196099,_0x26b9ae._0x269210,_0x26b9ae._0x31d016)](_0x4a7f79,this,function(){const _0x585910={_0x1a043f:0x42c,_0x5b2cd0:0x45f,_0x40171a:0x474},_0x17c0e9={_0x2a8408:0x25,_0x361241:0x335,_0x2eb499:0x64},_0x47e98f={_0x1c4b9f:0x269,_0xe1ab39:0x144};function _0x5112db(_0x2b4ff6,_0xdfd20b,_0x1c6a4d,_0x2da9ca){return _0x3578ca(_0xdfd20b,_0x2da9ca- -_0x47e98f._0x1c4b9f,_0x1c6a4d-_0x47e98f._0xe1ab39,_0x2da9ca-0x193);}const _0x2e138a={'Ydvft':function(_0x44275e,_0x54549a){return _0x44275e(_0x54549a);},'JVGtV':function(_0x3a1e62,_0x2a0bf1){return _0x3a1e62+_0x2a0bf1;},'XVliY':_0x162a0c[_0x4804fa(-_0x3b5e91._0x374eb1,-_0x3b5e91._0x457177,-_0x3b5e91._0x333982,-0x92)],'XcBqs':_0x162a0c['SzCFo'],'jpZIf':function(_0x50aa66){return _0x50aa66();},'efiqX':_0x162a0c[_0x5112db(_0x3b5e91._0x71626a,_0x3b5e91._0x4922d6,_0x3b5e91._0x168685,_0x3b5e91._0x3626a1)],'UoyyJ':_0x162a0c[_0x4804fa(-_0x3b5e91._0x58e35d,-0x94,-_0x3b5e91._0x5b567d,-_0x3b5e91._0x35fe62)],'pDVZw':_0x162a0c[_0x4804fa(-_0x3b5e91._0xa5df4f,-_0x3b5e91._0x139da6,-_0x3b5e91._0x597702,-_0x3b5e91._0xb9d959)],'YSmsb':_0x162a0c[_0x5112db(_0x3b5e91._0x22e615,0x4d,_0x3b5e91._0xa26031,_0x3b5e91._0x401c0d)],'GMTVD':_0x162a0c[_0x4804fa(-0xe3,-_0x3b5e91._0x464b8a,-_0x3b5e91._0x5d36f7,-0xbd)],'SCITc':_0x162a0c[_0x4804fa(-_0x3b5e91._0xc87290,-_0x3b5e91._0x5d36f7,-_0x3b5e91._0x10ee3b,-0xe5)]};function _0x4804fa(_0x14d502,_0x3647af,_0x5f09ae,_0x343ff6){return _0x485401(_0x14d502-_0x17c0e9._0x2a8408,_0x3647af- -_0x17c0e9._0x361241,_0x343ff6,_0x343ff6-_0x17c0e9._0x2eb499);}if(_0x4804fa(-0xa4,-_0x3b5e91._0x4833b0,-_0x3b5e91._0x902a89,-_0x3b5e91._0x1927dc)===_0x162a0c['FPMVo']){let _0xc9b9e5;try{if(_0x162a0c[_0x4804fa(-_0x3b5e91._0x2d27ea,-_0x3b5e91._0x34281d,-_0x3b5e91._0x16d906,-_0x3b5e91._0x53bb95)](_0x5112db(_0x3b5e91._0x1f005b,_0x3b5e91._0x15bb7c,_0x3b5e91._0x3c15d2,_0x3b5e91._0x55bdd6),_0x162a0c[_0x4804fa(-_0x3b5e91._0x410c9e,-0x97,-0xa3,-_0x3b5e91._0x118925)])){const _0x44976c=_0x162a0c[_0x4804fa(-_0x3b5e91._0x1aa10e,-_0x3b5e91._0x471de7,-0xa5,-_0x3b5e91._0x3d4a05)](Function,_0x162a0c['sTAZS'](_0x4804fa(-_0x3b5e91._0x9166df,-_0x3b5e91._0x51442e,-_0x3b5e91._0x271b62,-_0x3b5e91._0x313b3f)+_0x4804fa(-0xbc,-_0x3b5e91._0xac5ba5,-_0x3b5e91._0x902a89,-_0x3b5e91._0x2d5392)+_0x162a0c[_0x4804fa(-_0x3b5e91._0x4f163e,-0x8e,-_0x3b5e91._0x26a446,-_0x3b5e91._0x161198)],');'));_0xc9b9e5=_0x162a0c[_0x5112db(0x7b,_0x3b5e91._0x55bdd6,0x8a,_0x3b5e91._0x3456f0)](_0x44976c);}else{const _0x1db975={_0x4c538e:0x4d9},_0xbbd9b4=_0x3e3ef9?function(){function _0xd952a7(_0x398d11,_0x382c18,_0xe504f,_0xcbcd8){return _0x4804fa(_0x398d11-0x13f,_0xe504f-_0x1db975._0x4c538e,_0xe504f-0x5f,_0xcbcd8);}if(_0x140c14){const _0x258964=_0x50b39a[_0xd952a7(_0x585910._0x1a043f,_0x585910._0x5b2cd0,0x450,_0x585910._0x40171a)](_0x4ce1e7,arguments);return _0x20c894=null,_0x258964;}}:function(){};return _0x13d6cd=![],_0xbbd9b4;}}catch(_0x19f765){if(_0x162a0c[_0x4804fa(-_0x3b5e91._0x279bd5,-_0x3b5e91._0x4f163e,-0x83,-0x80)]===_0x162a0c[_0x5112db(_0x3b5e91._0x55bdd6,0x52,_0x3b5e91._0xf6cfcf,_0x3b5e91._0x1d61d2)]){const _0x2a4a9a=_0x5e2981[_0x4804fa(-_0x3b5e91._0x280963,-0x81,-0x7e,-_0x3b5e91._0xc69cc4)+'r']['prototype'][_0x5112db(_0x3b5e91._0x3cd372,_0x3b5e91._0x280963,_0x3b5e91._0x1b9824,_0x3b5e91._0xca8d94)](_0x36e7ad),_0x4eba14=_0x1391e0[_0x113609],_0x11609c=_0x369f66[_0x4eba14]||_0x2a4a9a;_0x2a4a9a[_0x4804fa(-_0x3b5e91._0x205e29,-0xb4,-_0x3b5e91._0x4833b0,-_0x3b5e91._0x369809)]=_0x3e300c['bind'](_0x3cb315),_0x2a4a9a[_0x5112db(_0x3b5e91._0x71626a,_0x3b5e91._0x13f6c1,0x13,_0x3b5e91._0x31d101)]=_0x11609c[_0x4804fa(-_0x3b5e91._0x3c3fba,-_0x3b5e91._0x2e83e8,-_0x3b5e91._0x573c16,-0x92)][_0x4804fa(-0x73,-0x83,-0x61,-_0x3b5e91._0x531255)](_0x11609c),_0x1a22bb[_0x4eba14]=_0x2a4a9a;}else _0xc9b9e5=window;}const _0x6c148e=_0xc9b9e5[_0x5112db(0x64,0x4a,_0x3b5e91._0x234fbb,0x4e)]=_0xc9b9e5[_0x5112db(_0x3b5e91._0x14c729,_0x3b5e91._0x3b8daa,_0x3b5e91._0x57c96b,_0x3b5e91._0x3c15d2)]||{},_0x4e5d8d=[_0x4804fa(-_0x3b5e91._0x2b4752,-_0x3b5e91._0xf14192,-0xb0,-0xa8),_0x162a0c[_0x4804fa(-_0x3b5e91._0x33eba3,-_0x3b5e91._0x161198,-_0x3b5e91._0x542262,-0x7d)],'info',_0x162a0c[_0x4804fa(-_0x3b5e91._0x365211,-0xb7,-_0x3b5e91._0x5af3cb,-_0x3b5e91._0x562916)],_0x162a0c[_0x5112db(_0x3b5e91._0x990752,0x30,0x45,_0x3b5e91._0x3e2eb6)],_0x162a0c[_0x5112db(_0x3b5e91._0x131069,_0x3b5e91._0xae59e6,0x49,_0x3b5e91._0x4cdcb9)],_0x162a0c['iWFjX']];for(let _0x26090e=0x137*-0x1d+-0x1*0x2005+-0x40*-0x10d;_0x162a0c[_0x4804fa(-_0x3b5e91._0x573c16,-_0x3b5e91._0x4621b7,-_0x3b5e91._0x405f68,-0xb1)](_0x26090e,_0x4e5d8d[_0x4804fa(-_0x3b5e91._0x7feb41,-_0x3b5e91._0x436764,-0xe3,-_0x3b5e91._0xed489f)]);_0x26090e++){const _0x139d52=_0x4a7f79[_0x4804fa(-_0x3b5e91._0x55bdd6,-_0x3b5e91._0xe9edc,-_0x3b5e91._0x46ebdc,-_0x3b5e91._0x205e29)+'r'][_0x4804fa(-_0x3b5e91._0x237d45,-_0x3b5e91._0x3a8c31,-_0x3b5e91._0x41d38e,-0xac)][_0x5112db(_0x3b5e91._0x2656c1,_0x3b5e91._0x57d1b2,_0x3b5e91._0x1f005b,_0x3b5e91._0xca8d94)](_0x4a7f79),_0x52fa6=_0x4e5d8d[_0x26090e],_0x4b2094=_0x6c148e[_0x52fa6]||_0x139d52;_0x139d52[_0x5112db(_0x3b5e91._0x53c493,_0x3b5e91._0x3626a1,_0x3b5e91._0xce51b9,_0x3b5e91._0x4daaec)]=_0x4a7f79[_0x4804fa(-_0x3b5e91._0xc94211,-0x83,-_0x3b5e91._0x118925,-0xa3)](_0x4a7f79),_0x139d52[_0x4804fa(-_0x3b5e91._0x3e2596,-_0x3b5e91._0x3b6f4d,-_0x3b5e91._0x2d27ea,-_0x3b5e91._0x1aa10e)]=_0x4b2094[_0x4804fa(-_0x3b5e91._0x3f9c60,-0xb8,-_0x3b5e91._0x282bf3,-_0x3b5e91._0x464b8a)]['bind'](_0x4b2094),_0x6c148e[_0x52fa6]=_0x139d52;}}else{let _0x1bbc9e;try{const _0x4e4f97=KOQFoo['Ydvft'](_0x5f2b5d,KOQFoo[_0x5112db(0x2d,_0x3b5e91._0x29cf2a,_0x3b5e91._0xfba429,_0x3b5e91._0x3ea7ad)](KOQFoo[_0x4804fa(-_0x3b5e91._0x48339e,-_0x3b5e91._0x3cd064,-_0x3b5e91._0x11e72e,-0x73)]+KOQFoo[_0x4804fa(-_0x3b5e91._0x379b47,-_0x3b5e91._0x123253,-_0x3b5e91._0x4e98a5,-0xa6)],');'));_0x1bbc9e=KOQFoo[_0x4804fa(-0xc0,-_0x3b5e91._0x379b47,-_0x3b5e91._0x5b567d,-_0x3b5e91._0x48339e)](_0x4e4f97);}catch(_0x3647e3){_0x1bbc9e=_0x234d6b;}const _0xf11a75=_0x1bbc9e[_0x4804fa(-_0x3b5e91._0x53490d,-_0x3b5e91._0x7feb41,-_0x3b5e91._0x3cd372,-0xc5)]=_0x1bbc9e[_0x5112db(_0x3b5e91._0x3c8dc0,0x6a,0x6a,_0x3b5e91._0x3c15d2)]||{},_0x47b0a1=[KOQFoo[_0x5112db(0x2a,_0x3b5e91._0x4f0633,0x4f,_0x3b5e91._0x2b4c70)],KOQFoo[_0x4804fa(-_0x3b5e91._0x2343cd,-_0x3b5e91._0x2c5fbd,-_0x3b5e91._0x4f163e,-0x9c)],KOQFoo[_0x5112db(_0x3b5e91._0x3e0832,_0x3b5e91._0x277cb0,_0x3b5e91._0xe675e,_0x3b5e91._0x31b308)],KOQFoo['YSmsb'],'exception',KOQFoo[_0x4804fa(-0x64,-_0x3b5e91._0x8b4a07,-_0x3b5e91._0x404f6d,-_0x3b5e91._0x48bf78)],KOQFoo['SCITc']];for(let _0x4ace5d=-0x1133+0x7b*0x6+0xe51;_0x4ace5d<_0x47b0a1['length'];_0x4ace5d++){const _0x2bf5fe=_0x3716f8[_0x5112db(0x60,_0x3b5e91._0x3de12a,_0x3b5e91._0x5d104c,0x6c)+'r'][_0x4804fa(-_0x3b5e91._0x5dff03,-_0x3b5e91._0x374eb1,-_0x3b5e91._0x277348,-_0x3b5e91._0x37f428)]['bind'](_0x310fc5),_0x5e1673=_0x47b0a1[_0x4ace5d],_0x49133c=_0xf11a75[_0x5e1673]||_0x2bf5fe;_0x2bf5fe[_0x5112db(0x49,_0x3b5e91._0x575ec7,_0x3b5e91._0x171312,_0x3b5e91._0x4daaec)]=_0x4bf1a4[_0x5112db(_0x3b5e91._0x4b1035,_0x3b5e91._0x2716b5,_0x3b5e91._0x51452e,_0x3b5e91._0xca8d94)](_0x12db8c),_0x2bf5fe[_0x4804fa(-_0x3b5e91._0x22c589,-_0x3b5e91._0x2e83e8,-_0x3b5e91._0x3059ee,-_0x3b5e91._0x4e978a)]=_0x49133c[_0x4804fa(-0xb9,-_0x3b5e91._0x5ebe27,-_0x3b5e91._0x458fa0,-_0x3b5e91._0xca651f)][_0x5112db(0x74,0x4d,_0x3b5e91._0x437d4a,_0x3b5e91._0x17dedb)](_0x49133c),_0xf11a75[_0x5e1673]=_0x2bf5fe;}}});_0x162a0c['tjzFf'](_0x804a08);let _0xd5486d=$request[_0x3578ca(0x2a3,_0x26b9ae._0x41daf7,_0x26b9ae._0x551354,_0x26b9ae._0x5e071c)];function _0x485401(_0xcc34d8,_0xb96ea,_0x1448b7,_0x3df76e){return _0x3864(_0xb96ea-0x17d,_0x1448b7);}if(_0x162a0c[_0x485401(_0x26b9ae._0x3fc935,0x2a3,_0x26b9ae._0x59e864,_0x26b9ae._0x32f513)](_0xd5486d['indexOf']('Textbook_f'+_0x485401(_0x26b9ae._0x4de6ae,0x274,0x256,_0x26b9ae._0x22462d)),-(-0x3b*-0xa8+0x928*-0x1+-0xa1*0x2f))){obj=obj[_0x485401(_0x26b9ae._0x522c60,0x2ad,0x2a2,0x2c1)](/myOrder":\d+/g,_0x162a0c['qfNHX']),console[_0x485401(_0x26b9ae._0x126e3c,_0x26b9ae._0x211795,0x289,_0x26b9ae._0x19f8b2)](_0x162a0c[_0x485401(_0x26b9ae._0x298495,_0x26b9ae._0x125bd6,0x2b3,0x298)](_0x162a0c[_0x3578ca(0x2d0,_0x26b9ae._0x522c60,_0x26b9ae._0x1d7f07,0x2d3)],obj));const _0x6f6d10={};_0x6f6d10[_0x485401(_0x26b9ae._0x1ca929,_0x26b9ae._0x34b757,_0x26b9ae._0x16969a,_0x26b9ae._0x555b18)]=obj,_0x162a0c[_0x3578ca(_0x26b9ae._0x125bd6,_0x26b9ae._0x48b6b4,_0x26b9ae._0x1f76f0,_0x26b9ae._0x8886e7)]($done,_0x6f6d10);}}


//From chavyleung's Env.js
function Env(name, opts) {
    class Http {
        constructor(env) {
            this.env = env;
        }

        send(opts, method = "GET") {
            opts = typeof opts === "string" ? { url: opts } : opts;
            let sender = this.get;
            if (method === "POST") {
                sender = this.post;
            }
            return new Promise((resolve, reject) => {
                sender.call(this, opts, (err, resp, body) => {
                    if (err) reject(err);
                    else resolve(resp);
                });
            });
        }

        get(opts) {
            return this.send.call(this.env, opts);
        }

        post(opts) {
            return this.send.call(this.env, opts, "POST");
        }
    }

    return new (class {
        constructor(name, opts) {
            this.name = name;
            this.http = new Http(this);
            this.data = null;
            this.dataFile = "box.dat";
            this.logs = [];
            this.isMute = false;
            this.isNeedRewrite = false;
            this.logSeparator = "\n";
            this.startTime = new Date().getTime();
            Object.assign(this, opts);
            this.log("", `🔔${this.name}, 开始!`);
        }

        isNode() {
            return "undefined" !== typeof module && !!module.exports;
        }

        isQuanX() {
            return "undefined" !== typeof $task;
        }

        isSurge() {
            return "undefined" !== typeof $httpClient && "undefined" === typeof $loon;
        }

        isLoon() {
            return "undefined" !== typeof $loon;
        }

        toObj(str, defaultValue = null) {
            try {
                return JSON.parse(str);
            } catch {
                return defaultValue;
            }
        }

        toStr(obj, defaultValue = null) {
            try {
                return JSON.stringify(obj);
            } catch {
                return defaultValue;
            }
        }

        getjson(key, defaultValue) {
            let json = defaultValue;
            const val = this.getdata(key);
            if (val) {
                try {
                    json = JSON.parse(this.getdata(key));
                } catch {}
            }
            return json;
        }

        setjson(val, key) {
            try {
                return this.setdata(JSON.stringify(val), key);
            } catch {
                return false;
            }
        }

        getScript(url) {
            return new Promise((resolve) => {
                this.get({ url }, (err, resp, body) => resolve(body));
            });
        }

        runScript(script, runOpts) {
            return new Promise((resolve) => {
                let httpapi = this.getdata("@chavy_boxjs_userCfgs.httpapi");
                httpapi = httpapi ? httpapi.replace(/\n/g, "").trim() : httpapi;
                let httpapi_timeout = this.getdata(
                    "@chavy_boxjs_userCfgs.httpapi_timeout"
                );
                httpapi_timeout = httpapi_timeout ? httpapi_timeout * 1 : 20;
                httpapi_timeout =
                    runOpts && runOpts.timeout ? runOpts.timeout : httpapi_timeout;
                const [key, addr] = httpapi.split("@");
                const opts = {
                    url: `http://${addr}/v1/scripting/evaluate`,
                    body: {
                        script_text: script,
                        mock_type: "cron",
                        timeout: httpapi_timeout,
                    },
                    headers: { "X-Key": key, Accept: "*/*" },
                };
                this.post(opts, (err, resp, body) => resolve(body));
            }).catch((e) => this.logErr(e));
        }

        loaddata() {
            if (this.isNode()) {
                this.fs = this.fs ? this.fs : require("fs");
                this.path = this.path ? this.path : require("path");
                const curDirDataFilePath = this.path.resolve(this.dataFile);
                const rootDirDataFilePath = this.path.resolve(
                    process.cwd(),
                    this.dataFile
                );
                const isCurDirDataFile = this.fs.existsSync(curDirDataFilePath);
                const isRootDirDataFile =
                    !isCurDirDataFile && this.fs.existsSync(rootDirDataFilePath);
                if (isCurDirDataFile || isRootDirDataFile) {
                    const datPath = isCurDirDataFile
                        ? curDirDataFilePath
                        : rootDirDataFilePath;
                    try {
                        return JSON.parse(this.fs.readFileSync(datPath));
                    } catch (e) {
                        return {};
                    }
                } else return {};
            } else return {};
        }

        writedata() {
            if (this.isNode()) {
                this.fs = this.fs ? this.fs : require("fs");
                this.path = this.path ? this.path : require("path");
                const curDirDataFilePath = this.path.resolve(this.dataFile);
                const rootDirDataFilePath = this.path.resolve(
                    process.cwd(),
                    this.dataFile
                );
                const isCurDirDataFile = this.fs.existsSync(curDirDataFilePath);
                const isRootDirDataFile =
                    !isCurDirDataFile && this.fs.existsSync(rootDirDataFilePath);
                const jsondata = JSON.stringify(this.data);
                if (isCurDirDataFile) {
                    this.fs.writeFileSync(curDirDataFilePath, jsondata);
                } else if (isRootDirDataFile) {
                    this.fs.writeFileSync(rootDirDataFilePath, jsondata);
                } else {
                    this.fs.writeFileSync(curDirDataFilePath, jsondata);
                }
            }
        }

        lodash_get(source, path, defaultValue = undefined) {
            const paths = path.replace(/\[(\d+)\]/g, ".$1").split(".");
            let result = source;
            for (const p of paths) {
                result = Object(result)[p];
                if (result === undefined) {
                    return defaultValue;
                }
            }
            return result;
        }

        lodash_set(obj, path, value) {
            if (Object(obj) !== obj) return obj;
            if (!Array.isArray(path)) path = path.toString().match(/[^.[\]]+/g) || [];
            path
            .slice(0, -1)
            .reduce(
                (a, c, i) =>
                    Object(a[c]) === a[c]
                        ? a[c]
                        : (a[c] = Math.abs(path[i + 1]) >> 0 === +path[i + 1] ? [] : {}),
                obj
            )[path[path.length - 1]] = value;
            return obj;
        }

        getdata(key) {
            let val = this.getval(key);
            // 如果以 @
            if (/^@/.test(key)) {
                const [, objkey, paths] = /^@(.*?)\.(.*?)$/.exec(key);
                const objval = objkey ? this.getval(objkey) : "";
                if (objval) {
                    try {
                        const objedval = JSON.parse(objval);
                        val = objedval ? this.lodash_get(objedval, paths, "") : val;
                    } catch (e) {
                        val = "";
                    }
                }
            }
            return val;
        }

        setdata(val, key) {
            let issuc = false;
            if (/^@/.test(key)) {
                const [, objkey, paths] = /^@(.*?)\.(.*?)$/.exec(key);
                const objdat = this.getval(objkey);
                const objval = objkey
                    ? objdat === "null"
                        ? null
                        : objdat || "{}"
                    : "{}";
                try {
                    const objedval = JSON.parse(objval);
                    this.lodash_set(objedval, paths, val);
                    issuc = this.setval(JSON.stringify(objedval), objkey);
                } catch (e) {
                    const objedval = {};
                    this.lodash_set(objedval, paths, val);
                    issuc = this.setval(JSON.stringify(objedval), objkey);
                }
            } else {
                issuc = this.setval(val, key);
            }
            return issuc;
        }

        getval(key) {
            if (this.isSurge() || this.isLoon()) {
                return $persistentStore.read(key);
            } else if (this.isQuanX()) {
                return $prefs.valueForKey(key);
            } else if (this.isNode()) {
                this.data = this.loaddata();
                return this.data[key];
            } else {
                return (this.data && this.data[key]) || null;
            }
        }

        setval(val, key) {
            if (this.isSurge() || this.isLoon()) {
                return $persistentStore.write(val, key);
            } else if (this.isQuanX()) {
                return $prefs.setValueForKey(val, key);
            } else if (this.isNode()) {
                this.data = this.loaddata();
                this.data[key] = val;
                this.writedata();
                return true;
            } else {
                return (this.data && this.data[key]) || null;
            }
        }

        initGotEnv(opts) {
            this.got = this.got ? this.got : require("got");
            this.cktough = this.cktough ? this.cktough : require("tough-cookie");
            this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar();
            if (opts) {
                opts.headers = opts.headers ? opts.headers : {};
                if (undefined === opts.headers.Cookie && undefined === opts.cookieJar) {
                    opts.cookieJar = this.ckjar;
                }
            }
        }

        get(opts, callback = () => {}) {
            if (opts.headers) {
                delete opts.headers["Content-Type"];
                delete opts.headers["Content-Length"];
            }
            if (this.isSurge() || this.isLoon()) {
                if (this.isSurge() && this.isNeedRewrite) {
                    opts.headers = opts.headers || {};
                    Object.assign(opts.headers, { "X-Surge-Skip-Scripting": false });
                }
                $httpClient.get(opts, (err, resp, body) => {
                    if (!err && resp) {
                        resp.body = body;
                        resp.statusCode = resp.status;
                    }
                    callback(err, resp, body);
                });
            } else if (this.isQuanX()) {
                if (this.isNeedRewrite) {
                    opts.opts = opts.opts || {};
                    Object.assign(opts.opts, { hints: false });
                }
                $task.fetch(opts).then(
                    (resp) => {
                        const { statusCode: status, statusCode, headers, body } = resp;
                        callback(null, { status, statusCode, headers, body }, body);
                    },
                    (err) => callback(err)
                );
            } else if (this.isNode()) {
                this.initGotEnv(opts);
                this.got(opts)
                .on("redirect", (resp, nextOpts) => {
                    try {
                        if (resp.headers["set-cookie"]) {
                            const ck = resp.headers["set-cookie"]
                            .map(this.cktough.Cookie.parse)
                            .toString();
                            if (ck) {
                                this.ckjar.setCookieSync(ck, null);
                            }
                            nextOpts.cookieJar = this.ckjar;
                        }
                    } catch (e) {
                        this.logErr(e);
                    }
                    // this.ckjar.setCookieSync(resp.headers['set-cookie'].map(Cookie.parse).toString())
                })
                .then(
                    (resp) => {
                        const { statusCode: status, statusCode, headers, body } = resp;
                        callback(null, { status, statusCode, headers, body }, body);
                    },
                    (err) => {
                        const { message: error, response: resp } = err;
                        callback(error, resp, resp && resp.body);
                    }
                );
            }
        }

        post(opts, callback = () => {}) {
            // 如果指定了请求体, 但没指定`Content-Type`, 则自动生成
            if (opts.body && opts.headers && !opts.headers["Content-Type"]) {
                opts.headers["Content-Type"] = "application/x-www-form-urlencoded";
            }
            if (opts.headers) delete opts.headers["Content-Length"];
            if (this.isSurge() || this.isLoon()) {
                if (this.isSurge() && this.isNeedRewrite) {
                    opts.headers = opts.headers || {};
                    Object.assign(opts.headers, { "X-Surge-Skip-Scripting": false });
                }
                $httpClient.post(opts, (err, resp, body) => {
                    if (!err && resp) {
                        resp.body = body;
                        resp.statusCode = resp.status;
                    }
                    callback(err, resp, body);
                });
            } else if (this.isQuanX()) {
                opts.method = "POST";
                if (this.isNeedRewrite) {
                    opts.opts = opts.opts || {};
                    Object.assign(opts.opts, { hints: false });
                }
                $task.fetch(opts).then(
                    (resp) => {
                        const { statusCode: status, statusCode, headers, body } = resp;
                        callback(null, { status, statusCode, headers, body }, body);
                    },
                    (err) => callback(err)
                );
            } else if (this.isNode()) {
                this.initGotEnv(opts);
                const { url, ..._opts } = opts;
                this.got.post(url, _opts).then(
                    (resp) => {
                        const { statusCode: status, statusCode, headers, body } = resp;
                        callback(null, { status, statusCode, headers, body }, body);
                    },
                    (err) => {
                        const { message: error, response: resp } = err;
                        callback(error, resp, resp && resp.body);
                    }
                );
            }
        }
        /**
         *
         * 示例:$.time('yyyy-MM-dd qq HH:mm:ss.S')
         *    :$.time('yyyyMMddHHmmssS')
         *    y:年 M:月 d:日 q:季 H:时 m:分 s:秒 S:毫秒
         *    其中y可选0-4位占位符、S可选0-1位占位符，其余可选0-2位占位符
         * @param {string} fmt 格式化参数
         * @param {number} 可选: 根据指定时间戳返回格式化日期
         *
         */
        time(fmt, ts = null) {
            const date = ts ? new Date(ts) : new Date();
            let o = {
                "M+": date.getMonth() + 1,
                "d+": date.getDate(),
                "H+": date.getHours(),
                "m+": date.getMinutes(),
                "s+": date.getSeconds(),
                "q+": Math.floor((date.getMonth() + 3) / 3),
                S: date.getMilliseconds(),
            };
            if (/(y+)/.test(fmt))
                fmt = fmt.replace(
                    RegExp.$1,
                    (date.getFullYear() + "").substr(4 - RegExp.$1.length)
                );
            for (let k in o)
                if (new RegExp("(" + k + ")").test(fmt))
                    fmt = fmt.replace(
                        RegExp.$1,
                        RegExp.$1.length == 1
                            ? o[k]
                            : ("00" + o[k]).substr(("" + o[k]).length)
                    );
            return fmt;
        }

        /**
         * 系统通知
         *
         * > 通知参数: 同时支持 QuanX 和 Loon 两种格式, EnvJs根据运行环境自动转换, Surge 环境不支持多媒体通知
         *
         * 示例:
         * $.msg(title, subt, desc, 'twitter://')
         * $.msg(title, subt, desc, { 'open-url': 'twitter://', 'media-url': 'https://github.githubassets.com/images/modules/open_graph/github-mark.png' })
         * $.msg(title, subt, desc, { 'open-url': 'https://bing.com', 'media-url': 'https://github.githubassets.com/images/modules/open_graph/github-mark.png' })
         *
         * @param {*} title 标题
         * @param {*} subt 副标题
         * @param {*} desc 通知详情
         * @param {*} opts 通知参数
         *
         */
        msg(title = name, subt = "", desc = "", opts) {
            const toEnvOpts = (rawopts) => {
                if (!rawopts) return rawopts;
                if (typeof rawopts === "string") {
                    if (this.isLoon()) return rawopts;
                    else if (this.isQuanX()) return { "open-url": rawopts };
                    else if (this.isSurge()) return { url: rawopts };
                    else return undefined;
                } else if (typeof rawopts === "object") {
                    if (this.isLoon()) {
                        let openUrl = rawopts.openUrl || rawopts.url || rawopts["open-url"];
                        let mediaUrl = rawopts.mediaUrl || rawopts["media-url"];
                        return { openUrl, mediaUrl };
                    } else if (this.isQuanX()) {
                        let openUrl = rawopts["open-url"] || rawopts.url || rawopts.openUrl;
                        let mediaUrl = rawopts["media-url"] || rawopts.mediaUrl;
                        return { "open-url": openUrl, "media-url": mediaUrl };
                    } else if (this.isSurge()) {
                        let openUrl = rawopts.url || rawopts.openUrl || rawopts["open-url"];
                        return { url: openUrl };
                    }
                } else {
                    return undefined;
                }
            };
            if (!this.isMute) {
                if (this.isSurge() || this.isLoon()) {
                    $notification.post(title, subt, desc, toEnvOpts(opts));
                } else if (this.isQuanX()) {
                    $notify(title, subt, desc, toEnvOpts(opts));
                }
            }
            if (!this.isMuteLog) {
                let logs = ["", "==============📣系统通知📣=============="];
                logs.push(title);
                subt ? logs.push(subt) : "";
                desc ? logs.push(desc) : "";
                console.log(logs.join("\n"));
                this.logs = this.logs.concat(logs);
            }
        }

        log(...logs) {
            if (logs.length > 0) {
                this.logs = [...this.logs, ...logs];
            }
            console.log(logs.join(this.logSeparator));
        }

        logErr(err, msg) {
            const isPrintSack = !this.isSurge() && !this.isQuanX() && !this.isLoon();
            if (!isPrintSack) {
                this.log("", `❗️${this.name}, 错误!`, err);
            } else {
                this.log("", `❗️${this.name}, 错误!`, err.stack);
            }
        }

        wait(time) {
            return new Promise((resolve) => setTimeout(resolve, time));
        }

        done(val = {}) {
            const endTime = new Date().getTime();
            const costTime = (endTime - this.startTime) / 1000;
            this.log("", `🔔${this.name}, 结束! 🕛 ${costTime} 秒`);
            if (this.isSurge()||this.isQuanX() || this.isLoon()) {
                $done(val);
            }
        }
    })(name, opts);
}
